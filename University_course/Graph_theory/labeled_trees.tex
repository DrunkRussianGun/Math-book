\section{Помеченные деревья}
\index{Дерево!помеченное} Дерево с $n$~вершинами, которым сопоставлены числа~$1, \ldots, n$, называется \textbf{помеченным}.

\index{Код Прюфера} Каждому помеченному дереву можно взаимнооднозначно сопоставить последовательность из $n \opbr- 2$~чисел от $1$ до $n$, называемую \textbf{кодом Прюфера}.
Алгоритм построения кода Прюфера для помеченного дерева~$G = (V, E)$:
\begin{enumerate}
	\item Выбираем висячую вершину~$v$ с наименьшим номером.
	\item Добавляем номер вершины, смежной с~$v$, в~код.
	\item Удаляем~$v$ и ребро, инцидентное $v$, из дерева.
	\item Повторить, начиная с шага~1, $n - 2$~раза.
\end{enumerate}

\begin{statement}
Различным помеченным деревьям соответствуют различные коды Прюфера.
\end{statement}
\begin{proofmathind}
	\indbase При $n = 3$ легко проверить.
	\indstep Пусть утверждение верно при $n$, $G = (V, E)$ и $G' = (V', E')$~--- различные помеченные деревья с $n + 1$~вершинами в~каждом.
	Если в $G$ и $G'$ вершины с наименьшим номером смежны с вершинами с одинаковыми номерами, то выполняем шаг построения кода, тогда оставшиеся деревья различны, значит, по предположению индукции у них различные коды. \indend
\end{proofmathind}

Алгоритм построения дерева по коду $A_0 = (a_0, \ldots, a_{n-3})$.

Пусть $B_0 = \{ 1, \ldots, n \}$.
\begin{enumerate}
	\item Находим наименьшее $b \in B_i \colon b \notin A_i$.
	Тогда в~дереве есть ребро $\{ b, a_i \}$: $A_{i+1} = A_i \setminus \{ a_i \} \lAnd B_{i+1} \opbr= B_i \setminus \{ b \}$.
	\item Повторяем шаг~1 $n - 2$~раз.
	Получим $B_{n-2} = \{ b', b'' \}$, значит, в~дереве есть ребро~$\{ b', b'' \}$.
\end{enumerate}

Докажем, что указанный алгоритм по коду из $n$~чисел строит дерево.
\begin{proofmathind}
	\indbase При $n = 1$ легко проверить.
	\indstep Рассмотрим графы $T_1, \ldots, T_{n-1}$, полученные в~процессе построения дерева.
	$T_1$ не содержит циклов.
	$T_2$ получается из $T_1$ либо добавлением новой вершины, либо добавлением моста, что не приводит к появлению цикла.	
	По индукции получим, что $T_{n-1}$ не содержит циклов и содержит $n$~вершин и $n - 1$~ребёр, значит, $T_{n-1}$~--- дерево.
	\indend
\end{proofmathind}

\index{Теорема!Кэли}
\begin{theorem}[Кэли]
Количество неизоморфных помеченных деревьев с $n$~вершинами равно~$n^{n-2}$.
\end{theorem}