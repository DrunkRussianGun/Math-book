\section{Помеченные деревья}
\begin{definition}
	Дерево с $n$ вершинами, которым сопоставлены числа $1, \ldots, n$, называется \textbf{помеченным}.
\end{definition}

\subsection{Код Прюфера}
	Каждому помеченному дереву можно взаимнооднозначно сопоставить последовательность из $(n - 2)$ чисел от $1$ до $n$, называемая \textbf{кодом Прюфера}. Алгоритм построения кода Прюфера для помеченного дерева $G = (V, E)$:
\begin{enumerate}
	\item Выбираем висячую вершину $v$ с наименьшим номером.
	\item Добавляем номер вершины, смежной с $v$, в код.
	\item Удаляем $v$ и ребро, инцидентное $v$, из дерева.
	\item Повторить, начиная с шага 1, $(n - 2)$ раза.
\end{enumerate}

\begin{statement}
	Различным помеченным деревьям соответствуют различные коды Прюфера.
\end{statement}
\begin{proofmathind}
	\indbase При $n = 3$ легко проверить.
	\indstep Пусть утверждение верно при $n \geqslant 3$, $G = (V, E)$ и $G' = (V', E')$~--- различные помеченные деревья с $(n + 1)$ вершинами в каждом.
	\begin{enumerate}
		\item Пусть в $G$ и $G'$ вершины с наименьшим номером смежны с вершинами с различными номерами.
		\item Пусть в $G$ и $G'$ вершины с наименьшим номером смежны с вершинами с одинаковыми номерами. Выполняем шаг построения кода, тогда оставшиеся деревья различны, значит, по предположению индукции у них различные коды.
	\end{enumerate}
	\indend
\end{proofmathind}

	Алгоритм построения дерева по коду $A_0 = (a_1, \ldots, a_{n-2})$.
\begin{enumerate}
	\item Пусть $B_0 = (1, \ldots, n)$.
	\item Находим наименьшее $b \in B_i \colon b \notin A_i$. Тогда в дереве есть ребро $\{ b, a_i \}$. $A_{i+1} = A_i \setminus \{ a_i \}$, $B_{i+1} = B_i \setminus \{ b \}$.
	\item Повторяем шаг 2 $(n - 2)$ раз. Получим $B_{n-2} = \{ b', b'' \}$, значит, в дереве есть ребро $\{ b', b'' \}$.
\end{enumerate}

\begin{statement}
	Указанный алгоритм построения дерева по коду из $n$ чисел строит дерево.
\end{statement}
\begin{proofmathind}
	\indbase При $n = 1$ легко проверить.
	\indstep Рассмотрим графы $T_1, \ldots, T_{n-1}$, полученные в процессе построения дерева. $T_1$ не содежрит циклов. $T_2$ получается из $T_1$ либо добавлением новой вершины, либо добавлением моста, что не приводит к появлению цикла.
	
	$T_{n-1}$ не содержит циклов и содержит $n$ вершин и $(n - 1)$ ребёр, значит, $T_{n-1}$~--- дерево.
	\indend
\end{proofmathind}

\begin{theorem}[Кэли]
	Пусть $G = (V, E)$~--- дерево, $n = |V|$, вершинам $G$ сопоставлены числа $1, \ldots, n$. Всего можно составить $n^{n-2}$ таких неизоморфных деревьев.
\end{theorem}